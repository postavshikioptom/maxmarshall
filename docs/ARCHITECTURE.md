# Архитектура Сайта Блога Max Marhsall. Посты берет из Github Multiverse, а зедсь только две страницы
1. Project Vision

A minimalist, high-performance static blog that mimics the UX/UI of X.com (Twitter). It is a "child" site designed to consume static assets (HTML/JSON) generated by a CMS like Decap CMS.
2. Technical Requirements

    Language: HTML5, CSS3, Vanilla JavaScript (ES6+).
    Style: Dark mode by default (#000000 background).
    Responsive: Mobile-first approach with breakpoints at 768px and 1024px.
    Data Source: Fetching from /posts/ directory and a posts.json index.

3. Implementation Roadmap
Phase 1: Core Layout & Shell (HTML/CSS)

    1.1. CSS Variable Definitions: Setup colors (--bg: #000, --surface: #121212, --accent: #1d9bf0, --border: #2f3336).
    1.2. Global Reset & Typography: Implement a clean sans-serif stack (Inter/System-fonts).
    1.3. Header Component: Create a fixed top bar with a glass effect (backdrop-filter: blur) and the "X-Blog" logo.
    1.4. Sidebar Components:
        Left (Nav): Vertical menu with icons for Home, Explore, and Profile.
        Right (Widgets): "Latest Posts" and "Categories" panels with border-radius and high-contrast text.
    1.5. Feed Container: A central scrollable area with a max-width of 600px-700px to maintain the "timeline" feel.

Phase 2: Dynamic Content Engine (JavaScript)

    2.1. Content Fetcher: Create a function to fetch() the posts.json index file on page load.
    2.2. Template Engine: Build a JS function that converts JSON post data into the "Tweet-style" card HTML seen in the design.
    2.3. Article View Logic:
        Use URLSearchParams or window.location.hash to detect when a user clicks a post.
        Create a "View Switcher" that hides the feed and shows the full article content dynamically.
    2.4. Search Functionality: Implement a real-time filter that listens to the header input and filters the displayed cards by title or tags.
    2.5. Infinite Loading: Add a "Show more" button or Intersection Observer to append the next 10 posts from the array.

Phase 3: Post Page & Social Features

    3.1. Detailed Post Layout: Render full markdown/HTML content with clear headers and image placeholders.
    3.2. Social Actions Bar: Functional JS to copy the post link to the clipboard and share to X/Twitter.
    3.3. Placeholder Comments: A minimalist, non-functional UI section for engagement metrics (likes/replies) to match the social vibe.

Phase 4: CMS & Deployment Preparation

    4.1. Decap CMS Config: Create admin/config.yml to define fields (title, date, excerpt, image, body).
    4.2. Folder Structure:
        /index.html (The main application)
        /styles.css
        /app.js
        /posts/ (Where individual post JSON/HTML files will live)
        /admin/ (Decap CMS entry point)
    4.3. Assets: Placeholder logic for images (using Unsplash IDs or local uploads).

The architecture is now fully defined. This plan ensures that the "child" site remains lightweight and fast while providing a modern, app-like experience.

=======
Да, сгенерированный мною выше код уже содержит обе страницы (и главную ленту Home, и страницу статьи Article) внутри одного HTML-файла.
Как это работает в коде:

    Два вида в одном: В блоке <body> есть два основных контейнера: <div id="feed-view"> (для ленты) и <div id="article-view"> (для самой статьи).
    Переключение без перезагрузки: JavaScript-функции viewArticle(id) и showFeed() мгновенно скрывают один блок и показывают другой. Это создает ощущение работы полноценного веб-приложения (SPA), как сам X.com.
    Динамическое наполнение: Когда вы нажимаете на карточку поста в ленте, скрипт берет данные этого поста и мгновенно "рисует" страницу статьи внутри контейнера #article-body.

Почему это удобно?

    Скорость: Переключение между лентой и статьей происходит мгновенно, так как браузеру не нужно загружать новую страницу с сервера.
    Простота: Вам нужно управлять только одним файлом index.html.
    Дизайн: Весь CSS-код (стили для ленты и для текста статьи) уже находится внутри тега <style>, поэтому обе части выглядят одинаково стильно в темной теме.

Что нужно сделать дальше?
===========
# ФАЗА 2: Код подгурзки постов с Decamp CMS ✅ ЗАВЕРШЕНО
# Обновлённый Подробный План Реализации Интеграции Decap CMS с Дочерним Сайтом (maxmarshall.indevs.in)

Этот план для другой AI-модели кодера. Основан на репозитории https://github.com/postavshikioptom/maxmarshall (файлы: index.html — главная лента, post.html — шаблон детального поста, примеры сгенерированных файлов). Всё на vanilla HTML/JS, Tailwind CDN, без фреймворков/npm/серверов.

Ключевые Новые Требования (обновления):
- Дизайн детальных постов: Использовать post.html как единый шаблон для ВСЕХ постов (старых и новых). JS в post.html динамически заменяет только контент (title, description, featured image, body, tags и т.д.). Когда редактируешь post.html (CSS, хедер, сайдбар, социальные кнопки) — все посты автоматически получают новый дизайн (при reload).
- Чистые читаемые URL: maxmarshall.indevs.in/moy-slug (без post.html, без ?slug=, без .html).
- Реализация URL: Через .htaccess (Apache rewrite) — все /slug → отдаёт post.html, JS читает slug из location.pathname.
- Главная (index.html): Лента последних 50 постов (превью-карточки в стиле твоего sample data). Ссылки на посты: href="/moy-slug" (чистый URL).
- Данные: Из Decap repo (https://github.com/postavshikioptom/multiverse_decapcms). Фильтр по target_site = 'maxmarshall'. Slug из frontmatter.
- Markdown: Body → HTML с marked.js CDN.
- Нет отдельных файлов: Один index.html (лента), один post.html (все детальные посты).

Общая Архитектура:
- Client-side: JS fetch из GitHub API/raw.
- Кэш: localStorage (24 часа).
- SEO: Динамически обновлять <title>, <meta description>, og:tags в JS.

**Задача 2.0: Создать .htaccess (Для Чистых URL) ** ✅ ЗАВЕРШЕНО
Подзадача 2.0.1: ✅ ЗАВЕРШЕНО Создать файл .htaccess в корне сайта (на ПК, затем FTP в корень maxmarshall.indevs.in).
   - Содержимое:
     ```
     RewriteEngine On

     # Если файл или папка реально существует (index.html, assets) — отдавать напрямую
     RewriteCond %{REQUEST_FILENAME} -f [OR]
     RewriteCond %{REQUEST_FILENAME} -d
     RewriteRule ^ - [L]

     # Главная / → index.html
     RewriteRule ^$ index.html [L]

     # Все остальные пути (slug) → post.html с query slug
     RewriteRule ^([^/]+)/?$ post.html?slug=$1 [QSA,L]
     ```
   - Почему: URL /moy-slug → сервер отдаёт post.html, но браузер видит чистый /moy-slug. JS читает slug из location.pathname.substring(1).

Подзадача 2.0.2: ✅ ЗАВЕРШЕНО Загрузить .htaccess по FTP (убедись, что хостинг поддерживает Apache/.htaccess — стандарт для shared).

**Задача 2.1: Общие Изменения (Для index.html и post.html)** ✅ ЗАВЕРШЕНО
Подзадача 2.1.1: ✅ ЗАВЕРШЕНО Добавить marked.js CDN в <head> обоих файлов.
   - Вставить перед </head>:
     ```html
     <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
     ```

Подзадача 2.1.2: ✅ ЗАВЕРШЕНО Добавить общую функцию loadPosts() в <script> в конце <body> обоих файлов.
   - Код (адаптирован под фильтр и slug):
     ```js
     const REPO = 'postavshikioptom/multiverse_decapcms';
     const BRANCH = 'main';
     const POSTS_FOLDER = 'content/posts';
     const TARGET_SITE = 'maxmarshall';

     async function loadPosts() {
       // Кэш (localStorage, 24 часа)
       const cacheKey = 'posts_cache_maxmarshall';
       const cached = localStorage.getItem(cacheKey);
       if (cached) {
         const { data, timestamp } = JSON.parse(cached);
         if (Date.now() - timestamp < 86400000) return data;
       }

       const listUrl = `https://api.github.com/repos/${REPO}/contents/${POSTS_FOLDER}?ref=${BRANCH}`;
       const response = await fetch(listUrl);
       if (!response.ok) return [];

       const files = await response.json();
       const posts = [];

       for (const file of files) {
         if (file.name.endsWith('.md')) {
           const rawUrl = file.download_url;
           const text = await fetch(rawUrl).then(res => res.text());

           const frontmatterMatch = text.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
           if (frontmatterMatch) {
             const fm = {};
             frontmatterMatch[1].split('\n').forEach(line => {
               const [key, ...value] = line.split(': ');
               if (key) fm[key.trim()] = value.join(': ').trim().replace(/^["']|["']$/g, '');
             });

             if (fm.target_site === TARGET_SITE || !fm.target_site) {
               posts.push({
                 title: fm.title || 'Без заголовка',
                 description: fm.description || '',
                 date: new Date(fm.date || '2026-01-01'),
                 slug: fm.slug || file.name.replace('.md', ''),
                 media: fm.media || '',  // featured image/video
                 body: marked.parse(frontmatterMatch[2].trim())
               });
             }
           }
         }
       }

       posts.sort((a, b) => b.date - a.date);
       localStorage.setItem(cacheKey, JSON.stringify({ data: posts, timestamp: Date.now() }));
       return posts;
     }
     ```

**Задача 2.2: Изменения в index.html (Главная Лента)** ✅ ЗАВЕРШЕНО
Подзадача 2.2.1: ✅ ЗАВЕРШЕНО Заменить статический const posts = [...] на динамический рендер.
   - Найти весь блок // Sample Post Data и массив posts.
   - Заменить на:
     ```js
     async function renderFeed() {
       const posts = await loadPosts();
       const feedContainer = document.querySelector('main > div:first-child');  // Адаптируй под твой контейнер ленты (или добавь id="feed")
       if (posts.length === 0) {
         feedContainer.innerHTML = '<p>Нет постов</p>';
         return;
       }

       const limited = posts.slice(0, 50);  // Последние 50
       feedContainer.innerHTML = limited.map(post => `
         <!-- Твой шаблон карточки поста из sample, но с динамикой -->
         <div class="post-card">
           <h2><a href="/${post.slug}">${post.title}</a></h2>
           <p>${post.description}</p>
           ${post.media ? `<img src="${post.media}" alt="">` : ''}
           <small>${post.date.toLocaleDateString('ru-RU')}</small>
         </div>
       `).join('');
     }

     window.addEventListener('load', renderFeed);
     ```
   - Ссылки: href="/${post.slug}" — чистый URL (работает с .htaccess).

Подзадача 2.2.2: ✅ ЗАВЕРШЕНО Добавить loading.
   - В контейнер ленты: <p id="loading">Загрузка постов...</p>
   - В JS: Скрыть после render.

**Задача 2.3: Изменения в post.html (Единый Шаблон Детального Поста)** ✅ ЗАВЕРШЕНО
Подзадача 2.3.1: ✅ ЗАВЕРШЕНО Заменить статический контент на динамический.
   - Найти <div class="mb-6"> (title + description) → добавить id="post-header".
   - Найти featured image div → id="featured-image".
   - Найти <article class="article-content"> → id="post-body".
   - Убрать весь статический текст внутри этих блоков (оставь placeholders: "Загрузка...").

Подзадача 2.3.2: ✅ ЗАВЕРШЕНО Добавить JS для рендера по slug из pathname.
   - В <script> в конце:
     ```js
     function getSlug() {
       return location.pathname.substring(1).split('?')[0];  // /moy-slug → moy-slug
     }

     async function renderPost() {
       const slug = getSlug();
       if (!slug) {
         document.getElementById('post-body').innerHTML = '<p>Пост не найден</p>';
         return;
       }

       const posts = await loadPosts();
       const post = posts.find(p => p.slug === slug);
       if (!post) {
         document.getElementById('post-body').innerHTML = '<p>Пост не найден (404)</p>';
         return;
       }

       // Title страницы + meta
       document.title = `${post.title} — X-Blog`;
       document.querySelector('meta[name="description"]').setAttribute('content', post.description);

       // Header
       document.getElementById('post-header').innerHTML = `
         <h1 class="text-3xl md:text-4xl font-black ...">${post.title}</h1>
         <p class="text-lg ...">${post.description}</p>
       `;

       // Featured
       document.getElementById('featured-image').innerHTML = post.media ? `
         <div class="w-full aspect-[16/9] ... " style="background-image: url('${post.media}')"></div>
       ` : '';

       // Body
       document.getElementById('post-body').innerHTML = post.body;

       // Tags/social — если есть в frontmatter, добавить
     }

     window.addEventListener('load', renderPost);
     ```

Подзадача 2.3.3: ✅ ЗАВЕРШЕНО Кнопка назад.
   - В конец post-body: `<button onclick="history.back()" class="...">← Назад</button>`

