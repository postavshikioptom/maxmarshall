<!DOCTYPE html>

<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta name="description" content="X-Blog Article View">
    <title>X-Blog Article View</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;family=Noto+Sans:wght@400;500&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1e9cf1",
                        "background-light": "#f5f7f8",
                        "background-dark": "#000000",
                        "sidebar-dark": "#16181c",
                        "border-dark": "#2f3336",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        body {
            font-family: "Plus Jakarta Sans", sans-serif;
        }
        .article-content p {
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        .article-content h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: white;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-200">
<div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
<!-- Top Navigation Bar -->
<header class="sticky top-0 z-50 flex items-center justify-center border-b border-solid border-border-dark bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md px-4 py-3">
<div class="flex w-full max-w-[1200px] items-center justify-between">
<div class="flex items-center gap-8">
<div class="flex items-center gap-4 text-primary">
<a href="/" class="flex items-center gap-2">
    <div class="size-8">
        <svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
            <path d="M42.1739 20.1739L27.8261 5.82609C29.1366 7.13663 28.3989 10.1876 26.2002 13.7654C24.8538 15.9564 22.9595 18.3449 20.6522 20.6522C18.3449 22.9595 15.9564 24.8538 13.7654 26.2002C10.1876 28.3989 7.13663 29.1366 5.82609 27.8261L20.1739 42.1739C21.4845 43.4845 24.5355 42.7467 28.1133 40.548C30.3042 39.2016 32.6927 37.3073 35 35C37.3073 32.6927 39.2016 30.3042 40.548 28.1133C42.7467 24.5355 43.4845 21.4845 42.1739 20.1739Z" fill="currentColor"></path>
        </svg>
    </div>
    <h2 class="text-xl font-black tracking-tight text-slate-900 dark:text-white">X-Blog</h2>
</a>
</div>
<nav class="hidden md:flex items-center gap-6">
<a class="text-sm font-medium hover:text-primary transition-colors" href="/">Home</a>
<a class="text-sm font-medium hover:text-primary transition-colors text-primary" href="#">Explore</a>
<a class="text-sm font-medium hover:text-primary transition-colors" href="#">Notifications</a>
</nav>
</div>
<div class="flex items-center gap-4">
<label class="hidden sm:flex min-w-40 h-10 max-w-64">
<div class="flex w-full items-stretch rounded-full bg-slate-200 dark:bg-sidebar-dark border border-transparent focus-within:border-primary focus-within:bg-background-dark transition-all">
<div class="flex items-center justify-center pl-4 text-slate-500">
<span class="material-symbols-outlined text-[20px]">search</span>
</div>
<input class="w-full bg-transparent border-none focus:ring-0 text-sm placeholder:text-slate-500 dark:text-white" placeholder="Search X-Blog" type="text"/>
</div>
</label>
<button class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-sidebar-dark transition-colors">
<span class="material-symbols-outlined text-slate-900 dark:text-white">settings</span>
</button>
<div class="size-9 rounded-full bg-cover bg-center border border-border-dark" data-alt="User profile avatar placeholder" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDEOwaBAVIIrCQFTItu_eyCcPYZ5WQ3oWQVGKhMAVqQ93lds8xmQh5hiHXWWtkvR6Xg2P8DTE1k5vMD8Y_Zue_8zmXmtYCmIrIOFVt1EyiraFQnaAPlKk4DCmRood5D3GcDHzPd9HbsVYcsFfx41kg9iydV5ZIeIOZGgThcB224NUdcBOCOqADBPvH5CddPF0ck8UklnJ08-O0XMHNVXKTadrPu9iNRR_VKKb1a3ijWgbvLlPJ-paFedWoaqw7DovF7BLDC3cCZgQ");'></div>
</div>
</div>
</header>
<main class="flex w-full max-w-[1200px] mx-auto grow px-4 py-6 gap-8">
<!-- Main Column -->
<div class="flex flex-col flex-1 max-w-[700px] min-w-0">
<!-- Breadcrumbs / Back Navigation -->
<div class="flex items-center gap-4 mb-4">
<button onclick="history.back()" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-sidebar-dark transition-colors">
<span class="material-symbols-outlined text-slate-900 dark:text-white">arrow_back</span>
</button>
<div class="flex flex-wrap gap-2 text-sm">
<a class="text-slate-500 font-medium hover:underline" href="/">Home</a>
<span class="text-slate-500">/</span>
<span class="text-slate-900 dark:text-white font-medium">Article</span>
</div>
</div>
<!-- Page Heading -->
<div class="mb-6" id="post-header">
<h1 class="text-3xl md:text-4xl font-black leading-tight tracking-tight text-slate-900 dark:text-white mb-4">
                    Загрузка...
                </h1>
</div>
<!-- Author / Metadata (ListItem style) -->
<div class="flex items-center justify-between border-y border-border-dark py-4 mb-6">
<div class="flex items-center gap-3">
<div class="size-12 rounded-full bg-cover bg-center" data-alt="Max Marshall" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDEOwaBAVIIrCQFTItu_eyCcPYZ5WQ3oWQVGKhMAVqQ93lds8xmQh5hiHXWWtkvR6Xg2P8DTE1k5vMD8Y_Zue_8zmXmtYCmIrIOFVt1EyiraFQnaAPlKk4DCmRood5D3GcDHzPd9HbsVYcsFfx41kg9iydV5ZIeIOZGgThcB224NUdcBOCOqADBPvH5CddPF0ck8UklnJ08-O0XMHNVXKTadrPu9iNRR_VKKb1a3ijWgbvLlPJ-paFedWoaqw7DovF7BLDC3cCZgQ");'></div>
<div class="flex flex-col" id="post-meta">
    <p class="text-slate-500 text-sm">Загрузка...</p>
</div>
</div>
<button class="rounded-full bg-slate-900 dark:bg-white px-5 py-1.5 text-sm font-bold text-white dark:text-black hover:opacity-90 transition-opacity">
                    Follow
                </button>
</div>
<!-- Featured Image (HeaderImage style) -->
<div id="featured-image"></div>
<!-- Article Content -->
<article class="article-content text-[17px] text-slate-700 dark:text-slate-300" id="post-body">
    <p>Загрузка...</p>
</article>
<!-- Social Action Bar -->
<div class="flex items-center justify-between border-y border-border-dark py-3 mt-8">
<div class="flex items-center gap-12 text-slate-500">
<button class="flex items-center gap-2 hover:text-primary transition-colors group">
<span class="material-symbols-outlined p-2 group-hover:bg-primary/10 rounded-full">chat_bubble</span>
<span class="text-sm">0</span>
</button>
<button class="flex items-center gap-2 hover:text-green-500 transition-colors group">
<span class="material-symbols-outlined p-2 group-hover:bg-green-500/10 rounded-full">repeat</span>
<span class="text-sm">0</span>
</button>
<button class="flex items-center gap-2 hover:text-pink-500 transition-colors group">
<span class="material-symbols-outlined p-2 group-hover:bg-pink-500/10 rounded-full">favorite</span>
<span class="text-sm">0</span>
</button>
<button class="flex items-center gap-2 hover:text-primary transition-colors group">
<span class="material-symbols-outlined p-2 group-hover:bg-primary/10 rounded-full">bookmark</span>
</button>
</div>
<button class="p-2 text-slate-500 hover:text-primary hover:bg-primary/10 rounded-full transition-colors">
<span class="material-symbols-outlined">share</span>
</button>
</div>
<!-- Comment Placeholder -->
<div class="mt-8">
<div class="flex gap-3">
<div class="size-10 rounded-full bg-cover bg-center shrink-0" data-alt="User avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDEOwaBAVIIrCQFTItu_eyCcPYZ5WQ3oWQVGKhMAVqQ93lds8xmQh5hiHXWWtkvR6Xg2P8DTE1k5vMD8Y_Zue_8zmXmtYCmIrIOFVt1EyiraFQnaAPlKk4DCmRood5D3GcDHzPd9HbsVYcsFfx41kg9iydV5ZIeIOZGgThcB224NUdcBOCOqADBPvH5CddPF0ck8UklnJ08-O0XMHNVXKTadrPu9iNRR_VKKb1a3ijWgbvLlPJ-paFedWoaqw7DovF7BLDC3cCZgQ");'></div>
<div class="flex-1">
<textarea class="w-full bg-transparent border-none focus:ring-0 text-lg placeholder:text-slate-500 resize-none px-0 min-h-[100px]" placeholder="Post your reply"></textarea>
<div class="flex items-center justify-between border-t border-border-dark pt-3">
<div class="flex gap-1 text-primary">
<span class="material-symbols-outlined p-2 hover:bg-primary/10 rounded-full cursor-pointer text-[20px]">image</span>
<span class="material-symbols-outlined p-2 hover:bg-primary/10 rounded-full cursor-pointer text-[20px]">gif_box</span>
<span class="material-symbols-outlined p-2 hover:bg-primary/10 rounded-full cursor-pointer text-[20px]">sentiment_satisfied</span>
</div>
<button class="bg-primary text-white font-bold px-6 py-2 rounded-full hover:bg-primary/90 transition-opacity opacity-50 cursor-not-allowed">
                                Reply
                            </button>
</div>
</div>
</div>
</div>
<div class="h-40"></div> <!-- Spacer -->
</div>
<!-- Right Sidebar -->
<aside class="hidden lg:flex flex-col w-[350px] gap-4">
<!-- Trending Card -->
<div class="rounded-xl bg-slate-100 dark:bg-sidebar-dark overflow-hidden border border-border-dark">
<h3 class="px-4 py-3 text-xl font-black text-slate-900 dark:text-white">Trending in Blog</h3>
<div class="flex flex-col cursor-pointer hover:bg-slate-200 dark:hover:bg-white/5 transition-colors px-4 py-3">
<p class="text-xs text-slate-500">Technology • Trending</p>
<p class="text-sm font-bold text-slate-900 dark:text-white mt-0.5">#WebDesign2024</p>
<p class="text-xs text-slate-500 mt-1">12.5K posts</p>
</div>
<div class="flex flex-col cursor-pointer hover:bg-slate-200 dark:hover:bg-white/5 transition-colors px-4 py-3">
<p class="text-xs text-slate-500">Development</p>
<p class="text-sm font-bold text-slate-900 dark:text-white mt-0.5">Rust vs TypeScript</p>
<p class="text-xs text-slate-500 mt-1">8,432 posts</p>
</div>
<div class="flex flex-col cursor-pointer hover:bg-slate-200 dark:hover:bg-white/5 transition-colors px-4 py-3">
<p class="text-xs text-slate-500">AI Trends</p>
<p class="text-sm font-bold text-slate-900 dark:text-white mt-0.5">Edge Intelligence</p>
<p class="text-xs text-slate-500 mt-1">2,105 posts</p>
</div>
<a class="block px-4 py-4 text-primary text-sm hover:bg-slate-200 dark:hover:bg-white/5 transition-colors" href="#">
                    Show more
                </a>
</div>
<!-- Recommended Authors -->
<div class="rounded-xl bg-slate-100 dark:bg-sidebar-dark overflow-hidden border border-border-dark">
<h3 class="px-4 py-3 text-xl font-black text-slate-900 dark:text-white">Who to follow</h3>
<div class="flex items-center justify-between px-4 py-3 hover:bg-slate-200 dark:hover:bg-white/5 cursor-pointer">
<div class="flex items-center gap-2">
<div class="size-10 rounded-full bg-cover bg-center" data-alt="Jordan Lee avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDO49gR6QpNawKBMkBq6cRMKLFqGLTZ-MeLJFB-ADI9CApTUnQmtIvkYAhRwqSYZxkKDUJuwNTtPIVYnqq4xZ2otMBSFUq6HRpEa4wBuepBkGXyySB8MZ6tuuFn6gFniJ9xjwRPzznAmAlQHgfyo14ruD3SR24uUvzYWhITdB-agXib6mTGxmoYm0CbFOXu5JGg3z_lpZay4arTlZfrY7bx5uUgp5hj2xN2RHDGZ0Wb7kd3Y6Z61SHcvWB2f3uFSxJ9ZcASaI5FYw");'></div>
<div class="flex flex-col">
<p class="text-sm font-bold dark:text-white leading-tight">Jordan Lee</p>
<p class="text-xs text-slate-500">@jlee_dev</p>
</div>
</div>
<button class="bg-slate-900 dark:bg-white text-white dark:text-black text-xs font-bold py-1.5 px-4 rounded-full">Follow</button>
</div>
<div class="flex items-center justify-between px-4 py-3 hover:bg-slate-200 dark:hover:bg-white/5 cursor-pointer">
<div class="flex items-center gap-2">
<div class="size-10 rounded-full bg-cover bg-center" data-alt="Sarah Chen avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCOehBU8BG_OPhl3L_lljmsK5CaztC8u1xKNqlhIFd6GBTCzAV0CqNgk3YC76dfWGK4nqKh-ODGkutassCuJDYXFIk2zy52zYTu-imoNZPl9q4hvP-xiqJiL3I8a8iquDeTJRLBw-u607GdTTRuIJlJ2-TXIa9pajFScCKtxbkEtFl_of3lE8M43KNZPdmzImyc6mcG-GqiwOjNShRDUAZeGjY-9NA31IbSNczlyxlXJhcLNje7QnMvb7ViLXb1tGmsieP6RGYiPw");'></div>
<div class="flex flex-col">
<p class="text-sm font-bold dark:text-white leading-tight">Sarah Chen</p>
<p class="text-xs text-slate-500">@sarah_codes</p>
</div>
</div>
<button class="bg-slate-900 dark:bg-white text-white dark:text-black text-xs font-bold py-1.5 px-4 rounded-full">Follow</button>
</div>
<a class="block px-4 py-4 text-primary text-sm hover:bg-slate-200 dark:hover:bg-white/5 transition-colors" href="#">
                    Show more
                </a>
</div>
<!-- Footer Links -->
<footer class="px-4 flex flex-wrap gap-x-3 gap-y-1">
<a class="text-xs text-slate-500 hover:underline" href="#">Terms of Service</a>
<a class="text-xs text-slate-500 hover:underline" href="#">Privacy Policy</a>
<a class="text-xs text-slate-500 hover:underline" href="#">Cookie Policy</a>
<a class="text-xs text-slate-500 hover:underline" href="#">Accessibility</a>
<a class="text-xs text-slate-500 hover:underline" href="#">Ads info</a>
<p class="text-xs text-slate-500">© 2026 X-Max Marshall</p>
</footer>
</aside>
</main>
</div>
<script>
    const REPO = 'postavshikioptom/multiverse_decapcms';
    const BRANCH = 'main';
    const POSTS_FOLDER = 'content/posts';
    const TARGET_SITE = 'maxmarshall';

    async function loadPosts() {
        const cacheKey = 'posts_cache_maxmarshall';
        const cached = localStorage.getItem(cacheKey);
        if (cached) {
            const { data, timestamp } = JSON.parse(cached);
            if (Date.now() - timestamp < 86400000) {
                return data.map(p => ({ ...p, date: new Date(p.date) }));
            }
        }

        try {
            const listUrl = `https://api.github.com/repos/${REPO}/contents/${POSTS_FOLDER}?ref=${BRANCH}`;
            const response = await fetch(listUrl);
            if (!response.ok) return [];

            const files = await response.json();
            const posts = [];

            for (const file of files) {
                if (file.name.endsWith('.md')) {
                    const rawUrl = file.download_url;
                    const text = await fetch(rawUrl).then(res => res.text());

                    const frontmatterMatch = text.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
                    if (frontmatterMatch) {
                        const fm = {};
                        frontmatterMatch[1].split('\n').forEach(line => {
                            const parts = line.split(': ');
                            const key = parts[0];
                            const value = parts.slice(1).join(': ');
                            if (key) fm[key.trim()] = (value || '').trim().replace(/^["']|["']$/g, '');
                        });

                        if (fm.target_site === TARGET_SITE || !fm.target_site) {
                            posts.push({
                                title: fm.title || 'Без заголовка',
                                description: fm.description || '',
                                date: new Date(fm.date || '2026-01-01'),
                                slug: fm.slug || file.name.replace('.md', ''),
                                media: fm.media || '',
                                body: marked.parse(frontmatterMatch[2].trim())
                            });
                        }
                    }
                }
            }

            posts.sort((a, b) => b.date - a.date);
            localStorage.setItem(cacheKey, JSON.stringify({ data: posts, timestamp: Date.now() }));
            return posts;
        } catch (error) {
            console.error('Error loading posts:', error);
            return [];
        }
    }

    function getSlug() {
        const params = new URLSearchParams(window.location.search);
        if (params.has('slug')) return params.get('slug');
        
        // Handle cases like /moy-slug if .htaccess is working
        const path = location.pathname.substring(1).split('?')[0];
        if (path && path !== 'post.html' && path !== 'index.html') return path;
        
        return null;
    }

    async function renderPost() {
        const slug = getSlug();
        const bodyContainer = document.getElementById('post-body');
        
        if (!slug) {
            bodyContainer.innerHTML = '<p class="p-8 text-center text-gray-500">Пост не выбран</p>';
            return;
        }

        const posts = await loadPosts();
        const post = posts.find(p => p.slug === slug);

        if (!post) {
            bodyContainer.innerHTML = '<p class="p-8 text-center text-gray-500">Пост не найден (404)</p>';
            return;
        }

        // Title страницы + meta
        document.title = `${post.title} — X-Blog`;
        const metaDesc = document.querySelector('meta[name="description"]');
        if (metaDesc) metaDesc.setAttribute('content', post.description);

        // Header
        document.getElementById('post-header').innerHTML = `
            <h1 class="text-3xl md:text-4xl font-black leading-tight tracking-tight text-slate-900 dark:text-white mb-4">
                ${post.title}
            </h1>
            <p class="text-lg text-slate-500 dark:text-slate-400 font-normal">
                ${post.description}
            </p>
        `;

        // Featured
        document.getElementById('featured-image').innerHTML = post.media ? `
            <div class="w-full aspect-[16/9] rounded-xl bg-center bg-no-repeat bg-cover mb-8 border border-border-dark" style="background-image: url('${post.media}')"></div>
        ` : '';

        // Body
        bodyContainer.innerHTML = post.body + `
            <div class="mt-10">
                <button onclick="history.back()" class="px-6 py-2 bg-primary text-white font-bold rounded-full hover:bg-primary/90 transition-colors">← Назад</button>
            </div>
        `;
        
        // Metadata
        document.getElementById('post-meta').innerHTML = `
            <div class="flex items-center gap-1">
                <p class="text-slate-900 dark:text-white font-bold leading-tight">Max Marshall</p>
                <span class="material-symbols-outlined text-primary text-[16px] font-fill">verified</span>
            </div>
            <p class="text-slate-500 text-sm">@max • ${post.date.toLocaleDateString('ru-RU')}</p>
        `;
    }

    window.addEventListener('load', renderPost);
</script>
</body></html>
